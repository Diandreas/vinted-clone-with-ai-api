<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - Authentification</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .debug-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .info {
            background: #dbeafe;
            border: 1px solid #3b82f6;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .warning {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .success {
            background: #d1fae5;
            border: 1px solid #10b981;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .btn {
            background: #4f46e5;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #4338ca;
        }
        .code {
            background: #f3f4f6;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            border: 1px solid #d1d5db;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üîç Debug - Authentification et Boutons de Modification</h1>
    
    <div class="debug-section">
        <h2>‚ùì Pourquoi le bouton "Modifier" ne s'affiche pas ?</h2>
        <p>Le bouton "Modifier le produit" ne s'affiche que si <strong>TOUTES</strong> ces conditions sont remplies :</p>
        
        <div class="info">
            <ol>
                <li><strong>Vous devez √™tre connect√©</strong> (authentifi√©)</li>
                <li><strong>Vous devez √™tre le propri√©taire</strong> du produit</li>
                <li><strong>Le produit doit √™tre charg√©</strong> dans la page</li>
            </ol>
        </div>
    </div>

    <div class="debug-section">
        <h2>üîß V√©rifications √† faire</h2>
        
        <h3>1. V√©rifiez que vous √™tes connect√©</h3>
        <p>Allez sur <code>http://localhost:8000/login</code> et connectez-vous avec votre compte.</p>
        
        <h3>2. V√©rifiez que vous √™tes le propri√©taire du produit</h3>
        <p>Le produit avec l'ID 1 doit appartenir √† votre compte utilisateur.</p>
        
        <h3>3. V√©rifiez la console du navigateur</h3>
        <p>Ouvrez la console (F12) et regardez les logs de debug qui commencent par üîç</p>
        
        <h3>4. V√©rifiez la section debug sur la page</h3>
        <p>Une section jaune de debug s'affiche maintenant sur la page du produit avec toutes les informations.</p>
    </div>

    <div class="debug-section">
        <h2>üß™ Tests √† effectuer</h2>
        
        <div class="warning">
            <strong>Test 1 : V√©rification de l'authentification</strong>
            <p>Allez sur <code>http://localhost:8000/products/1</code> et regardez la section debug.</p>
        </div>
        
        <div class="warning">
            <strong>Test 2 : V√©rification de la propri√©t√©</strong>
            <p>V√©rifiez que le produit appartient bien √† votre compte.</p>
        </div>
        
        <div class="warning">
            <strong>Test 3 : V√©rification des logs</strong>
            <p>Ouvrez la console et regardez les messages de debug.</p>
        </div>
    </div>

    <div class="debug-section">
        <h2>üìã Informations √† v√©rifier dans la console</h2>
        <p>Dans la console du navigateur, vous devriez voir :</p>
        
        <div class="code">
üîç Debug isProductOwner: {
  isAuthenticated: true/false,
  currentUserId: votre_id_utilisateur,
  productUserId: id_proprietaire_produit,
  result: true/false
}
        </div>
        
        <p>Si <code>result</code> est <code>false</code>, regardez pourquoi :</p>
        <ul>
            <li><code>isAuthenticated: false</code> ‚Üí Vous n'√™tes pas connect√©</li>
            <li><code>currentUserId</code> ‚â† <code>productUserId</code> ‚Üí Vous n'√™tes pas le propri√©taire</li>
            <li><code>productUserId</code> est <code>undefined</code> ‚Üí Le produit n'est pas charg√©</li>
        </ul>
    </div>

    <div class="debug-section">
        <h2>üöÄ Solutions possibles</h2>
        
        <h3>Si vous n'√™tes pas connect√© :</h3>
        <ol>
            <li>Allez sur <code>http://localhost:8000/login</code></li>
            <li>Connectez-vous avec vos identifiants</li>
            <li>Retournez sur la page du produit</li>
        </ol>
        
        <h3>Si vous n'√™tes pas le propri√©taire :</h3>
        <ol>
            <li>Connectez-vous avec le compte qui poss√®de le produit</li>
            <li>Ou cr√©ez un nouveau produit avec votre compte</li>
        </ol>
        
        <h3>Si le produit n'est pas charg√© :</h3>
        <ol>
            <li>V√©rifiez que l'API fonctionne</li>
            <li>V√©rifiez que le produit existe</li>
            <li>Regardez les erreurs dans la console</li>
        </ol>
    </div>

    <div class="debug-section">
        <h2>üîó Liens utiles</h2>
        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
            <a href="http://localhost:8000/login" class="btn">üîê Page de connexion</a>
            <a href="http://localhost:8000/products" class="btn">üì¶ Liste des produits</a>
            <a href="http://localhost:8000/products/1" class="btn">üîç Produit ID 1</a>
        </div>
    </div>

    <script>
        // Fonction pour v√©rifier l'√©tat de l'authentification
        function checkAuthStatus() {
            console.log('üîç V√©rification de l\'√©tat de l\'authentification...');
            
            // V√©rifier si axios est disponible
            if (typeof window.axios !== 'undefined') {
                console.log('‚úÖ Axios est disponible');
                
                // Essayer de r√©cup√©rer les informations de l'utilisateur
                window.axios.get('/user')
                    .then(response => {
                        console.log('‚úÖ Utilisateur connect√©:', response.data);
                    })
                    .catch(error => {
                        console.log('‚ùå Utilisateur non connect√© ou erreur:', error.response?.status);
                    });
            } else {
                console.log('‚ùå Axios n\'est pas disponible');
            }
            
            // V√©rifier le localStorage pour les tokens
            const token = localStorage.getItem('token') || localStorage.getItem('auth_token');
            if (token) {
                console.log('‚úÖ Token trouv√© dans le localStorage');
            } else {
                console.log('‚ùå Aucun token trouv√© dans le localStorage');
            }
        }
        
        // V√©rifier au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            
            // Ajouter un bouton pour re-v√©rifier
            const checkButton = document.createElement('button');
            checkButton.textContent = 'üîÑ Re-v√©rifier l\'authentification';
            checkButton.className = 'btn';
            checkButton.onclick = checkAuthStatus;
            
            document.querySelector('.debug-section:last-child').appendChild(checkButton);
        });
    </script>
</body>
</html>


