<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Notifications - RIKEAA</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/pinia@2/dist/pinia.iife.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div id="app">
        <div class="min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/20 to-green-50/30">
            <div class="max-w-4xl mx-auto px-4 py-8">
                <h1 class="text-3xl font-bold text-center mb-8 text-gray-800">Test Système de Notifications</h1>
                
                <!-- Boutons de test -->
                <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                    <h2 class="text-xl font-semibold mb-4">Tester les notifications</h2>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <button @click="showSuccess" class="bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700">
                            Succès
                        </button>
                        
                        <button @click="showError" class="bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700">
                            Erreur
                        </button>
                        
                        <button @click="showInfo" class="bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700">
                            Info
                        </button>
                        
                        <button @click="showWarning" class="bg-yellow-600 text-white py-2 px-4 rounded-md hover:bg-yellow-700">
                            Attention
                        </button>
                    </div>
                    
                    <div class="mt-4">
                        <button @click="clearAll" class="bg-gray-600 text-white py-2 px-4 rounded-md hover:bg-gray-700">
                            Effacer toutes les notifications
                        </button>
                    </div>
                </div>
                
                <!-- État du store -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h2 class="text-xl font-semibold mb-4">État du store de notifications</h2>
                    <div class="bg-gray-100 p-4 rounded-md">
                        <p><strong>Nombre de notifications :</strong> {{ notifications.length }}</p>
                        <div v-if="notifications.length > 0" class="mt-2">
                            <p><strong>Notifications actives :</strong></p>
                            <ul class="list-disc list-inside mt-1">
                                <li v-for="notif in notifications" :key="notif.id">
                                    {{ notif.type }}: {{ notif.message }}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Composant de notification -->
        <NotificationToast />
    </div>

    <script>
        const { createApp, ref, computed } = Vue;
        const { createPinia, defineStore } = Pinia;
        
        // Store de notification
        const useNotificationStore = defineStore('notification', () => {
            const notifications = ref([]);
            
            const addNotification = (notification) => {
                const id = Date.now().toString();
                const newNotification = {
                    id,
                    type: 'info',
                    title: '',
                    message: '',
                    duration: 5000,
                    ...notification
                };
                
                notifications.value.push(newNotification);
                
                // Auto-remove after duration
                if (newNotification.duration > 0) {
                    setTimeout(() => {
                        removeNotification(id);
                    }, newNotification.duration);
                }
                
                return id;
            };
            
            const removeNotification = (id) => {
                const index = notifications.value.findIndex(n => n.id === id);
                if (index > -1) {
                    notifications.value.splice(index, 1);
                }
            };
            
            const clearAll = () => {
                notifications.value = [];
            };
            
            const success = (message, title = 'Succès', options = {}) => {
                return addNotification({
                    type: 'success',
                    title,
                    message,
                    ...options
                });
            };
            
            const error = (message, title = 'Erreur', options = {}) => {
                return addNotification({
                    type: 'error',
                    title,
                    message,
                    duration: 0,
                    ...options
                });
            };
            
            const info = (message, title = 'Information', options = {}) => {
                return addNotification({
                    type: 'info',
                    title,
                    message,
                    ...options
                });
            };
            
            const warning = (message, title = 'Attention', options = {}) => {
                return addNotification({
                    type: 'warning',
                    title,
                    message,
                    ...options
                });
            };
            
            return {
                notifications,
                addNotification,
                removeNotification,
                clearAll,
                success,
                error,
                info,
                warning
            };
        });
        
        // Composant NotificationToast
        const NotificationToast = {
            setup() {
                const notificationStore = useNotificationStore();
                const notifications = computed(() => notificationStore.notifications);
                
                const removeNotification = (id) => {
                    notificationStore.removeNotification(id);
                };
                
                return {
                    notifications,
                    removeNotification
                };
            },
            template: `
                <Teleport to="body">
                    <div 
                        v-if="notifications.length > 0"
                        class="fixed top-4 right-4 z-50 space-y-2"
                    >
                        <div
                            v-for="notification in notifications"
                            :key="notification.id"
                            :class="[
                                'flex items-center p-4 rounded-lg shadow-lg max-w-sm',
                                {
                                    'bg-green-50 border border-green-200': notification.type === 'success',
                                    'bg-red-50 border border-red-200': notification.type === 'error',
                                    'bg-blue-50 border border-blue-200': notification.type === 'info',
                                    'bg-yellow-50 border border-yellow-200': notification.type === 'warning'
                                }
                            ]"
                        >
                            <div class="flex-1">
                                <h4 
                                    v-if="notification.title"
                                    :class="[
                                        'font-medium text-sm',
                                        {
                                            'text-green-800': notification.type === 'success',
                                            'text-red-800': notification.type === 'error',
                                            'text-blue-800': notification.type === 'info',
                                            'text-yellow-800': notification.type === 'warning'
                                        }
                                    ]"
                                >
                                    {{ notification.title }}
                                </h4>
                                <p 
                                    :class="[
                                        'text-sm',
                                        {
                                            'text-green-700': notification.type === 'success',
                                            'text-red-700': notification.type === 'error',
                                            'text-blue-700': notification.type === 'info',
                                            'text-yellow-700': notification.type === 'warning'
                                        }
                                    ]"
                                >
                                    {{ notification.message }}
                                </p>
                            </div>
                            
                            <button
                                @click="removeNotification(notification.id)"
                                class="flex-shrink-0 ml-3 p-1 rounded-full hover:bg-gray-200 transition-colors"
                            >
                                <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </Teleport>
            `
        };
        
        // App principale
        createApp({
            components: {
                NotificationToast
            },
            setup() {
                const notificationStore = useNotificationStore();
                const notifications = computed(() => notificationStore.notifications);
                
                const showSuccess = () => {
                    notificationStore.success('Opération réussie !', 'Succès');
                };
                
                const showError = () => {
                    notificationStore.error('Une erreur est survenue !', 'Erreur');
                };
                
                const showInfo = () => {
                    notificationStore.info('Information importante', 'Info');
                };
                
                const showWarning = () => {
                    notificationStore.warning('Attention à ce point', 'Attention');
                };
                
                const clearAll = () => {
                    notificationStore.clearAll();
                };
                
                return {
                    notifications,
                    showSuccess,
                    showError,
                    showInfo,
                    showWarning,
                    clearAll
                };
            }
        }).use(createPinia()).mount('#app');
    </script>
</body>
</html>
